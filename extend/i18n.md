# Extend | i18n

This config is supposed to be quite minimalistic, and therefore purposefully lacks somes features. Follow this guide to use i18n in this project.

## Installation

First, install the [Nuxt i18n module](https://github.com/nuxt-community/nuxt-i18n) :

```bash
# install package as a dependency
$ yarn add nuxt-i18n
```

## Setup

In `nuxt.config.js`, add the package to modules array and the configuration object to go along with it :

```js
modules: [
	'nuxt-i18n'
],

i18n: {
	locales: [
		{
			code: 'en',
			file: 'en-US.js'
  		},
		{
			code: 'fr',
			file: 'fr-FR.js'
		}
	],
	defaultLocale: 'fr',
	vueI18n: {
		fallbackLocale: 'fr'
	},
	pages: {
		about: {
			en: '/about',
			fr: '/a-propos',
		},
		contact: {
			en: '/contact',
			fr: '/contact',
		}
	},
	detectBrowserLanguage: {
		useCookie: true,
		cookieKey: 'i18n_redirected'
	},
	lazy: true,
	langDir: 'lang/',
	parsePages: false
},
```

In src folder, add a `lang/` directory, and two files for translations `en-US.js` and `fr-FR.js`  :

```js
// en-US.js

export default {
	test: 'Hello'
}
```

```js
// fr-FR.js

export default {
	test: 'Bonjour'
}
```

In a page component, add this in `asyncData` to fetch content with current locale : 

```js
export default {
	async asyncData({ $prismic, app, error }) {
		try {
			let locale

			switch(app.i18n.locale) {
				case 'fr':
					locale = 'fr-fr'
					break
				case 'en':
					locale = 'en-us'
					break
			}

			const page = await $prismic.api.getSingle('home_page', { lang: locale })

			return {
				content: page.data,
			}
		} catch (e) {
			error({ statusCode: 404, message: 'Page not found' })
		}
	}
}
```

In a template, use `localePath` to create a localized link :

```html
<template>
	<nuxt-link :to="localePath('index', $i18n.locale)" exact>
		<span>Label</span>
	</nuxt-link>
</template>
```

In a template, use `switchLocalePath` to switch current locale :

```html
<div class="switcher">
	<nuxt-link :to="switchLocalePath('fr')">
		fr
	</nuxt-link>
	<nuxt-link :to="switchLocalePath('en')">
		en
	</nuxt-link>
</div>
```

If you are fetching for content based on dynamic route param, add this in `asyncData` and  in `created` hook :

```js
export default {
	async asyncData({ $prismic, app, params, error }) {
		// get locale like previously
	
		const document = await $prismic.api.getByUID('document', params.slug, { lang: locale })
	
		let slugs
		if(locale === 'fr-fr') {
			slugs = {
				en: document.alternate_languages[0].uid,
				fr: document.uid,
			}
		} else if(locale === 'en-us') {
			slugs = {
				en: document.uid,
				fr: document.alternate_languages[0].uid,
			}
		}
	
		return {
			content: document.data,
			slugs
		}
	},
	created() {
		this.$store.dispatch('i18n/setRouteParams', {
			en: { slug: this.slugs.en },
			fr: { slug: this.slugs.fr }
		})
	}
}
```
